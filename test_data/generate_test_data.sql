--generated via excel
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900281?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900282?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900283?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900284?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900285?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900286?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900287?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900288?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900289?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900290?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900291?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900292?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900293?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900294?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900295?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900296?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900297?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900298?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900299?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900300?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900301?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900302?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900303?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900304?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900305?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900306?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900307?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900308?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900309?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900310?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900311?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900312?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900313?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900314?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900315?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900316?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900317?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900318?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900319?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900320?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900321?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900322?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900323?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900324?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900325?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900326?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900327?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900328?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900329?', 'Pallet Receiving', 'dry');
insert into receiving_locations (receiving_location_id, receiving_location_type, temperature_zone) values ('204178900330?', 'Pallet Receiving', 'dry');


--generated via excel
INSERT INTO stocking_purchase_orders (status, supplier_id, date_ordered, date_confirmed, date_shipped, date_arrived) VALUES ('Confirmed', 1, '2014-12-14', '2014-12-14', null, null);
INSERT INTO stocking_purchase_orders (status, supplier_id, date_ordered, date_confirmed, date_shipped, date_arrived) VALUES ('Shipped', 1, '2014-12-15', '2014-12-15', '2014-12-20', null);
INSERT INTO stocking_purchase_orders (status, supplier_id, date_ordered, date_confirmed, date_shipped, date_arrived) VALUES ('Delivered', 1, '2014-12-18', '2014-12-18', '2014-12-19', '2014-12-22');
INSERT INTO stocking_purchase_orders (status, supplier_id, date_ordered, date_confirmed, date_shipped, date_arrived) VALUES ('Partially Delivered', 1, '2014-12-18', '2014-12-18', '2014-12-19', '2014-12-22');
INSERT INTO stocking_purchase_orders (status, supplier_id, date_ordered, date_confirmed, date_shipped, date_arrived) VALUES ('Requested', 1, '2014-12-20', null, null, null);
INSERT INTO stocking_purchase_orders (status, supplier_id, date_ordered, date_confirmed, date_shipped, date_arrived) VALUES ('Shipped', 1, '2014-12-15', '2014-12-15', '2014-12-20', null);
INSERT INTO stocking_purchase_orders (status, supplier_id, date_ordered, date_confirmed, date_shipped, date_arrived) VALUES ('Delivered', 1, '2014-12-18', '2014-12-18', '2014-12-19', '2014-12-22');
INSERT INTO stocking_purchase_orders (status, supplier_id, date_ordered, date_confirmed, date_shipped, date_arrived) VALUES ('Delivered', 1, '2014-12-18', '2014-12-18', '2014-12-19', '2014-12-22');
INSERT INTO stocking_purchase_orders (status, supplier_id, date_ordered, date_confirmed, date_shipped, date_arrived) VALUES ('Delivered', 1, '2014-12-15', '2014-12-15', '2014-12-18', '2014-12-20');
INSERT INTO stocking_purchase_orders (status, supplier_id, date_ordered, date_confirmed, date_shipped, date_arrived) VALUES ('Delivered', 1, '2014-12-15', '2014-12-15', '2014-12-18', '2014-12-20');
INSERT INTO stocking_purchase_orders (status, supplier_id, date_ordered, date_confirmed, date_shipped, date_arrived) VALUES ('Delivered', 1, '2014-12-15', '2014-12-15', '2014-12-18', '2014-12-20');
INSERT INTO stocking_purchase_orders (status, supplier_id, date_ordered, date_confirmed, date_shipped, date_arrived) VALUES ('Delivered', 1, '2014-12-15', '2014-12-15', '2014-12-18', '2014-12-20');
INSERT INTO stocking_purchase_orders (status, supplier_id, date_ordered, date_confirmed, date_shipped, date_arrived) VALUES ('Delivered', 1, '2014-12-15', '2014-12-15', '2014-12-18', '2014-12-20');
INSERT INTO stocking_purchase_orders (status, supplier_id, date_ordered, date_confirmed, date_shipped, date_arrived) VALUES ('Delivered', 1, '2014-12-15', '2014-12-15', '2014-12-18', '2014-12-20');
INSERT INTO stocking_purchase_orders (status, supplier_id, date_ordered, date_confirmed, date_shipped, date_arrived) VALUES ('Delivered', 1, '2014-12-15', '2014-12-15', '2014-12-18', '2014-12-20');
/*
'Unsent’, -> basic info not yet filled out, this is for purchasing. don’t need to have these yet
'Requested’, -> basic info filled out, need this for purchasing also. not needed for receiving
    ->Requested
'Confirmed’, -> basic info filled out, this is not materially different from Shipped for receiving purposes
    ->Confirmed or Unavailable
'Shipped’, -> this is the entry point into receiving
    ->Shipped or Unavailable
'Partially Delivered’, -> ones that have already been received and may need to be stocked, this is also useful for receiving
    -> Received, Stocked, Unfulfilled, or Received - Qty Mismatch
'Delivered’, -> ones that have already been received and may need to be stocked, this is also useful for receiving
    -> Received, Stocked, or Received - Qty Mismatch
‘Cancelled’ -> not needed for receiving
*/



--generate SPO products based on product data, SPO data and randomness
--run this some number of times to your liking (like 30+)
INSERT INTO stocking_purchase_order_products (stocking_purchase_order_id, sku, status, requested_qty, confirmed_qty, received_qty, case_upc,
            units_per_case, requested_case_qty, confirmed_case_qty, received_case_qty, case_length, case_width, case_height, case_weight,
            expected_arrival, actual_arrival, wholesale_cost, expiration_class, receiving_location_id)
select stocking_purchase_order_id, t.sku, ('[0:1]={Received, Stocked}'::text[])[floor(random()*2)]::stocking_purchase_order_product_status, r.qty*units_per_case as requested_qty, r.qty*units_per_case as confirmed_qty, r.qty*units_per_case as received_qty, case_upc,
            units_per_case, r.qty as requested_case_qty, r.qty as confirmed_case_qty,
            r.qty as received_case_qty, case_length, case_width, case_height, case_weight,
            date_arrived as expected_arrival, date_arrived as actual_arrival, s.wholesale_cost, expiration_class, receiving_location_id
FROM
(SELECT * FROM stocking_purchase_orders WHERE status = 'Delivered' OFFSET floor(random()*(select count(*) from stocking_purchase_orders
    WHERE status = 'Delivered')) LIMIT 1) as spo
, (SELECT sku, case_upc, units_per_case, case_length, case_width, case_height, case_weight, expiration_class FROM products OFFSET floor(random()*(select count(*) from products)) LIMIT 1) as t
,products_suppliers s, (select ceil(random()*3) as qty) as r,
(SELECT receiving_location_id FROM receiving_locations left join stocking_purchase_order_products s using (receiving_location_id) where s.sku is null OR status != 'Received' LIMIT 1) as l
WHERE spo.status = 'Delivered' and s.sku = t.sku and s.supplier_id = 1 limit 1;

--until this looks good:
select spo.stocking_purchase_order_id, count(stocking_purchase_order_product_id)
from stocking_purchase_orders spo left outer join stocking_purchase_order_products using(stocking_purchase_order_id)
WHERE spo.status = 'Delivered'
group by spo.stocking_purchase_order_id
order by count(stocking_purchase_order_product_id);




--run this some number of times
INSERT INTO stocking_purchase_order_products (stocking_purchase_order_id, sku, status, requested_qty, confirmed_qty, received_qty, case_upc,
            units_per_case, requested_case_qty, confirmed_case_qty, received_case_qty, case_length, case_width, case_height, case_weight,
            expected_arrival, actual_arrival, wholesale_cost, expiration_class, receiving_location_id)
select stocking_purchase_order_id, t.sku, CASE WHEN a.mult = 0 THEN 'Unfulfilled'::stocking_purchase_order_product_status ELSE ('[0:1]={Received, Stocked}'::text[])[floor(random()*2)]::stocking_purchase_order_product_status END, r.qty*units_per_case as requested_qty, r.qty*units_per_case as confirmed_qty, r.qty*units_per_case*a.mult as received_qty, case_upc,
            units_per_case, r.qty as requested_case_qty, r.qty as confirmed_case_qty,
            r.qty*a.mult as received_case_qty, case_length, case_width, case_height, case_weight,
            date_arrived as expected_arrival, case when a.mult = 0 then null else date_arrived end as actual_arrival, s.wholesale_cost, expiration_class, receiving_location_id
FROM
(SELECT * FROM stocking_purchase_orders WHERE status = 'Partially Delivered' OFFSET floor(random()*(select count(*) from stocking_purchase_orders
    WHERE status = 'Partially Delivered')) LIMIT 1) as spo
, (SELECT sku, case_upc, units_per_case, case_length, case_width, case_height, case_weight, expiration_class FROM products OFFSET floor(random()*(select count(*) from products)) LIMIT 1) as t
,products_suppliers s, (select ceil(random()*3) as qty) as r,
(select floor(random()*2) as mult) as a,
(SELECT receiving_location_id FROM receiving_locations left join stocking_purchase_order_products s using (receiving_location_id) where s.sku is null OR status != 'Received' LIMIT 1) as l
WHERE spo.status = 'Partially Delivered' and s.sku = t.sku and s.supplier_id = 1 limit 1;

--until this looks good:
select spo.stocking_purchase_order_id, count(stocking_purchase_order_product_id)
from stocking_purchase_orders spo left outer join stocking_purchase_order_products using(stocking_purchase_order_id)
WHERE spo.status = 'Partially Delivered'
group by spo.stocking_purchase_order_id
order by count(stocking_purchase_order_product_id);


--run this some number of times
INSERT INTO stocking_purchase_order_products (stocking_purchase_order_id, sku, status, requested_qty, confirmed_qty, received_qty, case_upc,
            units_per_case, requested_case_qty, confirmed_case_qty, received_case_qty, case_length, case_width, case_height, case_weight,
            expected_arrival, actual_arrival, wholesale_cost, expiration_class, receiving_location_id)
select stocking_purchase_order_id, t.sku, CASE WHEN a.mult = 0 THEN 'Unavailable'::stocking_purchase_order_product_status ELSE spo.status::varchar::stocking_purchase_order_product_status END, r.qty*units_per_case as requested_qty, r.qty*units_per_case*a.mult as confirmed_qty, null::int as received_qty, case_upc,
            units_per_case, r.qty as requested_case_qty, r.qty*a.mult as confirmed_case_qty,
            null::int as received_case_qty, case_length, case_width, case_height, case_weight,
            date_ordered + interval '3 days' as expected_arrival, date_arrived as actual_arrival, s.wholesale_cost, expiration_class, null
FROM
(SELECT * FROM stocking_purchase_orders WHERE status IN ('Confirmed', 'Shipped') OFFSET floor(random()*(select count(*) from stocking_purchase_orders
    WHERE status IN ('Confirmed', 'Shipped') LIMIT 1))) as spo
, (SELECT sku, case_upc, units_per_case, case_length, case_width, case_height, case_weight, expiration_class FROM products OFFSET floor(random()*(select count(*) from products)) LIMIT 1) as t
,products_suppliers s, (select ceil(random()*3) as qty) as r,
(select floor(random()*2) as mult) as a
WHERE spo.status IN ('Confirmed', 'Shipped') and s.sku = t.sku and s.supplier_id = 1 limit 1;

--until this looks good:
select spo.stocking_purchase_order_id, count(stocking_purchase_order_product_id)
from stocking_purchase_orders spo left outer join stocking_purchase_order_products using(stocking_purchase_order_id)
WHERE spo.status IN ('Confirmed', 'Shipped')
group by spo.stocking_purchase_order_id
order by count(stocking_purchase_order_product_id);


--run this some number of times
INSERT INTO stocking_purchase_order_products (stocking_purchase_order_id, sku, status, requested_qty, confirmed_qty, received_qty, case_upc,
            units_per_case, requested_case_qty, confirmed_case_qty, received_case_qty, case_length, case_width, case_height, case_weight,
            expected_arrival, actual_arrival, wholesale_cost, expiration_class, receiving_location_id)
select stocking_purchase_order_id, t.sku, 'Requested'::stocking_purchase_order_product_status, r.qty*units_per_case as requested_qty, null::int as confirmed_qty, null::int as received_qty, case_upc,
            units_per_case, r.qty as requested_case_qty, null::int as confirmed_case_qty,
            null::int as received_case_qty, case_length, case_width, case_height, case_weight,
            date_ordered + interval '3 days' as expected_arrival, date_arrived as actual_arrival, s.wholesale_cost, expiration_class, null
FROM
(SELECT * FROM stocking_purchase_orders WHERE status IN ('Requested') OFFSET floor(random()*(select count(*) from stocking_purchase_orders
    WHERE status IN ('Requested') LIMIT 1))) as spo
, (SELECT sku, case_upc, units_per_case, case_length, case_width, case_height, case_weight, expiration_class FROM products OFFSET floor(random()*(select count(*) from products)) LIMIT 1) as t
,products_suppliers s, (select ceil(random()*3) as qty) as r
WHERE spo.status IN ('Requested') and s.sku = t.sku and s.supplier_id = 1 limit 1;

--until this looks good:
select spo.stocking_purchase_order_id, count(stocking_purchase_order_product_id)
from stocking_purchase_orders spo left outer join stocking_purchase_order_products using(stocking_purchase_order_id)
WHERE spo.status IN ('Requested')
group by spo.stocking_purchase_order_id
order by count(stocking_purchase_order_product_id);


-------------------------------------------------------

--*SUPPLIER SHIPMENT*--
--run this until it gets nothing
insert into supplier_shipments (shipment_id, stocking_purchase_order_id, supplier_id)
SELECT trunc(random() * 1000000000 + 1)::varchar, stocking_purchase_order_id, 1
FROM stocking_purchase_orders
left join supplier_shipments using (stocking_purchase_order_id)
where shipment_id is null and status IN ('Delivered', 'Shipped', 'Partially Delivered', 'Confirmed') limit 1;

--then, for good measure
insert into supplier_shipments (shipment_id, stocking_purchase_order_id, supplier_id)
SELECT trunc(random() * 1000000000 + 1)::varchar, stocking_purchase_order_id, 1
FROM stocking_purchase_orders
join supplier_shipments using (stocking_purchase_order_id)
where status IN ('Delivered', 'Shipped', 'Partially Delivered', 'Confirmed') limit 1;

-------------------------------------------------------

--for tables that are writable to the module and need to be saved in test_data, here's how to dump the data to json:
--dump in json file:
--tuples only mode on (\t), aligned (\a) and expanded (\x) off, \pset recordsep ','
--then just add enclosing braces and paste, prettify json in sublime

select row_to_json(t)
from (
  select * from stocking_purchase_orders
) t;

--more complex data structure containing arrays
\o /opt/go/src/just-pikd-wms/test_data/spos.json
\qecho [
select row_to_json(t)
from (
  select spo.*,
    (
      select array_to_json(array_agg(row_to_json(d)))
      from (
        select *
        from stocking_purchase_order_products
        where stocking_purchase_order_id=spo.stocking_purchase_order_id
        order by stocking_purchase_order_product_id asc
      ) d
    ) as products
  from stocking_purchase_orders spo
  order by stocking_purchase_order_id asc
) as t;
\qecho ]


